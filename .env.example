# =============================================================================
# Monorepo env: Copy this to .env.local at the repo root.
# pnpm dev and pnpm build load .env.local and .env via dotenv-cli.
#
# File roles:
#   .env.local  - Local dev overrides (Supabase local, ngrok, etc). Loaded first.
#   .env        - Staging: vars to push to Vercel. Optional.
#   .env.production - Vercel pull target. Run: vercel env pull .env.production --environment=production
#                    Not loaded by pnpm dev; keeps prod vars separate.
#
# Vercel workflow:
#   Pull: vercel env pull .env.production --environment=production
#   Push: Add vars to .env or .env.local, then pnpm vercel:env-sync
# =============================================================================

# =============================================================================
# Supabase (required: URL + anon key + service role for server/API; use .env.local at repo root; pnpm dev loads it)
# =============================================================================
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=
NEXT_PUBLIC_SUPABASE_PROJECT_REF=
SUPABASE_MANAGEMENT_API_TOKEN=

# Supabase Auth – OAuth providers (local dev: config.toml uses these)
# Discord: Discord Developer Portal → Application → OAuth2. Redirect URI: http://localhost:54321/auth/v1/callback (local) or https://<project-ref>.supabase.co/auth/v1/callback (prod)
SUPABASE_AUTH_EXTERNAL_DISCORD_CLIENT_ID=
SUPABASE_AUTH_EXTERNAL_DISCORD_SECRET=
# GitHub: GitHub → Settings → Developer settings → OAuth Apps. Authorization callback URL: http://127.0.0.1:54321/auth/v1/callback (local) or https://<project-ref>.supabase.co/auth/v1/callback (prod)
# Values can be stored in Notion Credentials (MOOD MNKY Credentials) and copied here.
SUPABASE_AUTH_EXTERNAL_GITHUB_CLIENT_ID=
SUPABASE_AUTH_EXTERNAL_GITHUB_SECRET=

# =============================================================================
# Notion (MNKY MIND / MNKY VERSE)
# =============================================================================
# MNKY MIND API KEY — from Notion Credentials → Parent Program "Notion", Use Cases "MNKY MIND API KEY"
# Used by: lib/notion.ts, seed script, sync APIs, blog sync. See docs/CREDENTIALS-NOTION-MAPPING.md
NOTION_API_KEY=
# MNKY Manga sync: Notion database IDs (created under MNKY_MIND Databases)
# MNKY Manga Collections = manga series (e.g. World Traveler Series)
NOTION_MNKY_COLLECTIONS_DATABASE_ID=fc437b6b-1fae-42fd-a98b-20b08ed12716
# MNKY Manga Issues = one issue per collection (e.g. Passport of the Senses)
NOTION_MNKY_ISSUES_DATABASE_ID=f9110e0c-667a-4b0e-9497-ee7b8dd6b124
# Optional: Chapters, Panels, Hotspots (create in Notion and add IDs here)
# NOTION_MNKY_CHAPTERS_DATABASE_ID=
# NOTION_MNKY_PANELS_DATABASE_ID=
# NOTION_MNKY_HOTSPOTS_DATABASE_ID=
# MNKY MIND collective databases (default: MNKY_MIND Databases page ID)
NOTION_MNKY_MIND_DATABASE_ID=

# =============================================================================
# Jotform (funnel intake forms, webhooks)
# =============================================================================
JOTFORM_API_KEY=
# Optional: validate webhook requests via ?token= in URL
JOTFORM_WEBHOOK_SECRET=
# Optional: default https://api.jotform.com
# NEXT_PUBLIC_JOTFORM_BASE_URL=
# Optional: API key for script/curl access to funnel admin endpoints (x-api-key header)
# FUNNEL_ADMIN_API_KEY=

# =============================================================================
# Shopify
# =============================================================================
SHOPIFY_STORE_DOMAIN=
# Admin API token. For manga metaobject sync (Publish to Shopify): include write_metaobject_definitions, write_metaobjects, read_metaobjects.
SHOPIFY_ADMIN_API_TOKEN=
# App secret (Partner Dashboard → App setup → Client credentials). Used for webhook HMAC when SHOPIFY_WEBHOOK_SECRET is unset.
SHOPIFY_API_SECRET=
# For MNKY Rewards redemption (POST /api/rewards/redeem): Admin API token must include write_discounts (or equivalent) so createDiscountCode succeeds.
NEXT_PUBLIC_SHOPIFY_STORE_DOMAIN=

# MNKY VERSE Storefront API (Hydrogen channel - Shopify Admin → Hydrogen → MNKY VERSE)
# Get tokens from: Hydrogen → Environments and variables. Copy from Notion: MOOD MNKY Credentials database
NEXT_PUBLIC_STORE_DOMAIN=
PUBLIC_STORE_DOMAIN=
NEXT_PUBLIC_STOREFRONT_API_TOKEN=
PUBLIC_STOREFRONT_API_TOKEN=
PRIVATE_STOREFRONT_API_TOKEN=
PUBLIC_STOREFRONT_ID=
NEXT_PUBLIC_STOREFRONT_ID=

# MNKY VERSE - Customer Account API (Authenticate with Shopify on /verse)
# No leading/trailing spaces or newlines or Shopify returns "invalid client credentials"
PUBLIC_CUSTOMER_ACCOUNT_API_CLIENT_ID=
PUBLIC_CUSTOMER_ACCOUNT_API_URL=
# Optional: paste from Shopify app "Application endpoints" to skip discovery (recommended for stability)
# PUBLIC_CUSTOMER_ACCOUNT_API_AUTHORIZE_URL=https://shopify.com/authentication/YOUR_SHOP_ID/oauth/authorize
# PUBLIC_CUSTOMER_ACCOUNT_API_TOKEN_URL=https://shopify.com/authentication/YOUR_SHOP_ID/oauth/token
# PUBLIC_CUSTOMER_ACCOUNT_API_LOGOUT_URL=https://shopify.com/authentication/YOUR_SHOP_ID/logout
# Example (MNKY VERSE app 69343281426):
# PUBLIC_CUSTOMER_ACCOUNT_API_AUTHORIZE_URL=https://shopify.com/authentication/69343281426/oauth/authorize
# PUBLIC_CUSTOMER_ACCOUNT_API_TOKEN_URL=https://shopify.com/authentication/69343281426/oauth/token
# PUBLIC_CUSTOMER_ACCOUNT_API_LOGOUT_URL=https://shopify.com/authentication/69343281426/logout
SHOP_ID=

# Base URL for mood-mnky-command app. Used for theme integration (App CTA section).
# Set in theme editor: Theme customizer → App CTA section → App base URL.
# Dev: http://localhost:3000 | Prod: https://mnky-command.moodmnky.com
# For local Customer Account API: set to ngrok URL (e.g. https://unupbraiding-unilobed-eustolia.ngrok-free.dev)
NEXT_PUBLIC_APP_URL=

# MNKY VERSE / Gamification — App Proxy & Webhooks
# Used by: /apps/mnky/session (JWT for theme), Flowise tools. Same value in Flowise as moodMnkyApiKey.
MOODMNKY_API_KEY=
# Remix/Hydrogen session secret (full Hydrogen storefront)
# SESSION_SECRET=
# Optional: dedicated secret for App Proxy JWT signing. If unset, MOODMNKY_API_KEY is used.
# APP_PROXY_JWT_SECRET=
# Webhook HMAC verification (orders/paid → XP). If unset, SHOPIFY_API_SECRET is used.
# SHOPIFY_WEBHOOK_SECRET=

# MNKY VERSE storefront domain. Used when request origin unavailable (fallback in auth callbacks).
# Prod: https://mnky-verse.moodmnky.com
NEXT_PUBLIC_VERSE_APP_URL=

# Main public marketing site (www.moodmnky.com). Used for canonical URL, metadata, and CTAs.
# Prod: https://www.moodmnky.com
NEXT_PUBLIC_MAIN_APP_URL=
# Dojo "Current issue" link: when set, Dojo home shows this slug as the featured issue (overrides first published).
# NEXT_PUBLIC_FEATURED_ISSUE_SLUG=

# ngrok: full domain (e.g. unupbraiding-unilobed-eustolia.ngrok-free.dev) or subdomain for .ngrok-free.app
# Claim at https://dashboard.ngrok.com/cloud-edge/domains
# For local Shopify Customer Account API: if NEXT_PUBLIC_APP_URL is unset, callback URL is built as https://NGROK_DOMAIN.
# NGROK_DOMAIN=unupbraiding-unilobed-eustolia.ngrok-free.dev
# NGROK_DOMAIN_ID=rd_38XBK3SC6E899PG49l1gy78KBqs

# =============================================================================
# OpenAI (MOOD MNKY — Studio AI images, Platform AI-SQL, AI Chat)
# =============================================================================
# MOOD MNKY — from Notion Credentials → Parent Program "OpenAI", Use Cases "MOOD_MNKY"
OPENAI_API_KEY=
# Optional: OPENAI_ORG_ID for MOOD MNKY org scoping
# OPENAI_ORG_ID=

# AI Chat: Base URL for internal API calls (e.g. image generation from tools).
# Uses NEXT_PUBLIC_APP_URL when set; otherwise defaults to http://localhost:3000.

# =============================================================================
# Flowise (Dojo Blending Lab, Platform panel, Custom Tools)
# =============================================================================
# See docs/FLOWISE-FRAGRANCE-CRAFTING.md and docs/VERCEL-ENV-SYNC.md for setup.
# Server-side: used by lib/flowise/client.ts, Platform Flowise panel, and tool proxies.
FLOWISE_BASE_URL=
# Required for predictions (Dojo chat). Create in Flowise: Settings → API Keys; assign the key to your chatflow.
FLOWISE_API_KEY=
# Flowise tools (MOOD MNKY API): Custom Tools call /api/flowise/tools/* with Authorization: Bearer.
# Use same value as MOODMNKY_API_KEY in Flowise chatflow config.

# Client-side (Dojo embed, Blending Lab): required for flowise-embed-react.
# Dev example: https://flowise-dev.moodmnky.com
NEXT_PUBLIC_FLOWISE_HOST=
# Chatflow ID for the Dojo Blending Lab chatflow (Flowise UI → Chatflow → Settings).
NEXT_PUBLIC_FLOWISE_CHATFLOW_ID=
# Optional: encrypts per-user Flowise API keys (Dojo chat). At least 32 chars (e.g. 32-byte hex).
# When set, Dojo can use profile-specific keys from flowise_chatflow_assignments.
# FLOWISE_KEY_ENCRYPTION_SECRET=

# Flowise (hosted instance) — S3/MinIO storage for document store
# These are used by the Flowise instance itself; app proxies document store requests via FLOWISE_BASE_URL.
# For local Flowise with S3: set in Flowise .env. No app code reads these directly.
# STORAGE_TYPE=s3
# BLOB_STORAGE_PATH=/root/.flowise/storage
# S3_STORAGE_BUCKET_NAME=flowise-dev
# S3_STORAGE_ACCESS_KEY_ID=
# S3_STORAGE_SECRET_ACCESS_KEY=
# S3_STORAGE_REGION=us-east-1
# S3_ENDPOINT_URL=https://s3-api-data.moodmnky.com
# S3_FORCE_PATH_STYLE=true

# =============================================================================
# n8n (CODE MNKY — batch workflows, image automation; also MNKY AUTO service analytics)
# =============================================================================
# Example: https://n8n-dev.moodmnky.com. Create API key in n8n: Settings → API.
N8N_API_URL=
N8N_API_KEY=

# =============================================================================
# Deployed Services (MNKY CLOUD, MNKY MEDIA, MNKY DRIVE — Service Analytics + /main status)
# See docs/SERVICES-ENV.md. MNKY AUTO = n8n above; MNKY AGENTS = Flowise below.
# Required for LABZ Settings → Deployed services (DB-stored credentials). Generate with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Set in .env.local and Vercel → Settings → Environment Variables (production).
# =============================================================================
SERVICES_CREDENTIALS_ENCRYPTION_KEY=
# MNKY CLOUD (Nextcloud): instance URL and OAuth2 client (Admin → Security → OAuth2). See docs/NEXTCLOUD-INTEGRATION.md.
# NEXTCLOUD_URL=https://mnky-cloud.moodmnky.com
# NEXTCLOUD_OAUTH_CLIENT_ID=
# NEXTCLOUD_OAUTH_CLIENT_SECRET=
# Optional: admin user and app password (Basic auth / admin operations). Not used by service status; for future or manual API use.
# NEXTCLOUD_ADMIN_USER=admin
# NEXTCLOUD_APP_PASSWORD=
# MNKY MEDIA (Jellyfin): server URL and API key (Dashboard → API Keys)
# JELLYFIN_BASE_URL=https://watch.moodnky.com
# JELLYFIN_API_KEY=
# MNKY DRIVE (TrueNAS Scale): URL and user API key (System → API Keys). HTTPS required.
# TRUENAS_BASE_URL=https://truenas-data.moodmnky.com
# TRUENAS_API_KEY=
# MNKY GAMES (featured game: Palworld): REST API base URL (e.g. http://host:8212), Basic Auth password = server AdminPassword. Optional: PALWORLD_API_USER (default admin). See docs/SERVICES-ENV.md.
# PALWORLD_SERVER_URL=
# PALWORLD_API_PASSWORD=
# PALWORLD_API_USER=admin
# Steam (MNKY GAMES — Link Steam, Now Playing): Web API key from https://steamcommunity.com/dev/apikey.
# Server-only; used for GetPlayerSummaries after linking. Sync to Vercel for the env where the app runs.
STEAM_WEB_API_KEY=
# Optional: pin Steam OpenID to one domain (e.g. mnky-verse). When set, link and callback use these instead of request origin.
STEAM_REALM=
STEAM_RETURN_URL=

# =============================================================================
# Media API / n8n (upload-from-url, update-image)
# =============================================================================
# Preferred: MEDIA_API_KEY. Legacy: CDN_API_KEY (deprecated)
# Used when n8n or external systems call app's upload-from-url endpoint
MEDIA_API_KEY=

# =============================================================================
# MCP / Research (Tavily, Brave, Firecrawl, 21st.dev Magic — Cursor MCP, deep research)
# =============================================================================
# From Notion Credentials. Used by mcp-setup.md, deep-thinking, docs scripts.
TAVILY_API_KEY=
BRAVE_API_KEY=
FIRECRAWL_API_KEY=
# 21st.dev Magic MCP (@21st-dev/magic): AI UI component generation (create-ui, refine-ui, logo-search). Get key at https://21st.dev/magic/console
# MAGIC_21ST_API_KEY=

# =============================================================================
# ElevenLabs (MOOD MNKY voice agent — Verse + LABZ + Main)
# @elevenlabs/client / @elevenlabs/react: agent ID from config (public); API key server-only.
# =============================================================================
ELEVEN_LABS_API_KEY=
# NEXT_PUBLIC_ELEVENLABS_AGENT_ID=
# Main landing: optional fallback for "Listen" sample (else from LABZ Main ElevenLabs config)
# NEXT_PUBLIC_MAIN_LANDING_AUDIO_SAMPLE_URL=

# =============================================================================
# Adobe PDF Services (formula export - POST /api/formulas/[id]/export-pdf)
# =============================================================================
# From Adobe Developer Console: Add PDF Services API to your project, create OAuth Server-to-Server credentials
PDF_SERVICES_CLIENT_ID=
PDF_SERVICES_CLIENT_SECRET=

# =============================================================================
# Rate limiting (Upstash Redis) for mag/ugc endpoints. When unset, limits are not enforced.
# App also accepts KV_REST_API_URL and KV_REST_API_TOKEN (e.g. from Upstash dashboard) as fallback.
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# =============================================================================
# Discord (MNKY VERSE Community + LABZ control panel)
# =============================================================================
# Public; used on /verse/community for "Join Discord" button. Set in Vercel for production.
NEXT_PUBLIC_DISCORD_INVITE_URL=https://discord.gg/CTad3UJwCy
# Bot token (LABZ Discord panel: send messages, webhooks, roles, moderation). From Discord Developer Portal → Bot.
# DISCORD_BOT_TOKEN_MNKY_VERSE=
# Optional: default guild for server-side jobs (drops webhook, scheduled messages). Resolve via: pnpm exec dotenv -e .env.local -- node scripts/get-discord-guild-id.mjs
# DISCORD_GUILD_ID_MNKY_VERSE=
# Discord OAuth for Supabase (Login with Discord) is configured via SUPABASE_AUTH_EXTERNAL_DISCORD_* above.
# Encrypts webhook tokens stored in DB (create/execute webhooks from LABZ). Generate with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Use a new 64-char hex value; keep the same value per environment or existing stored webhooks cannot be decrypted.
DISCORD_WEBHOOK_ENCRYPTION_KEY=

# =============================================================================
# Discord Agent Bots (MOOD MNKY, SAGE MNKY, CODE MNKY) — services/discord-bots
# =============================================================================
# Store tokens in Notion Credentials; copy into .env.local (or env_file for Docker) when running the bot stack.
# Create three Discord applications in Discord Developer Portal; one bot token per agent.
MOOD_MNKY_DISCORD_BOT_TOKEN=
SAGE_MNKY_DISCORD_BOT_TOKEN=
CODE_MNKY_DISCORD_BOT_TOKEN=
# Redis for the bot stack (Docker: redis://redis:6379; local: redis://localhost:6379).
# Bots use this for rate limiting and optional session cache. Web app uses UPSTASH_* for serverless.
REDIS_URL=
# Web app base URL for profile-by-discord-id and agent-reply APIs. Bots use MOODMNKY_API_KEY for auth.
# Use NEXT_PUBLIC_APP_URL (or NEXT_PUBLIC_VERSE_APP_URL) value when running bots.
# VERSE_APP_URL=
